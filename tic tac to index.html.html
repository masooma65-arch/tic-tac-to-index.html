<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tic‑Tac‑Toe</title>
  <!-- Tailwind CDN for quick prototyping -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Small, focused extra styles */
    .cell {
      aspect-ratio: 1 / 1; /* keep square */
      -webkit-tap-highlight-color: transparent;
    }
    .cell:hover {
      transform: translateY(-2px);
    }
    .winning {
      box-shadow: 0 0 0 4px rgba(121, 190, 147, 0.12) inset;
      background: linear-gradient(180deg, rgba(13, 88, 40, 0.06), transparent);
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen flex items-center justify-center p-6">
  <main class="w-full max-w-xl">
    <section class="bg-white rounded-2xl shadow-lg p-6">
      <h1 class="text-2xl font-semibold text-gray-800 mb-4">Tic‑Tac‑Toe</h1>

      <!-- Status row -->
      <div class="flex items-center justify-between gap-4 mb-4">
        <div class="flex items-center gap-3">
          <div id="turnBadge" class="px-3 py-1 rounded-full bg-indigo-50 text-indigo-700 font-medium">X's turn</div>
          <div id="message" class="text-sm text-gray-600">Two players — take turns clicking empty squares.</div>
        </div>
        <div class="flex items-center gap-2">
          <div class="text-sm text-gray-500">Score</div>
          <div class="px-3 py-1 bg-gray-100 rounded-md text-sm">
            <span id="scoreX">X: 0</span> · <span id="scoreO">O: 0</span> · <span id="scoreT">Ties: 0</span>
          </div>
        </div>
      </div>

      <!-- Game board -->
      <div id="board" class="grid grid-cols-3 gap-3">
        <!-- 9 cells generated by JS for clarity -->
      </div>

      <!-- Controls -->
      <div class="mt-5 flex gap-3">
        <button id="restartBtn" class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">Restart Round</button>
        <button id="resetScoreBtn" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300">Reset Scores</button>
        <button id="swapBtn" class="px-3 py-2 ml-auto bg-emerald-50 text-emerald-700 rounded-lg">Swap Starting Player</button>
      </div>

      <footer class="mt-4 text-xs text-gray-400"></footer>
    </section>
  </main>

  <script>
    /* -----------------------------
       Tic-Tac-Toe game logic (vanilla JS)
       - Two players: X and O
       - Alternating turns
       - Win detection, highlight winning line
       - Scores & ties
       - Cleanly commented
       ------------------------------*/

    // Game state
    const state = {
      board: Array(9).fill(null), // null | 'X' | 'O'
      currentPlayer: 'X',
      startedBy: 'X', // keeps track who started the round
      running: true,
      scores: { X: 0, O: 0, T: 0 }
    };

    // Winning masks (indices) — three in a row
    const wins = [
      [0,1,2], [3,4,5], [6,7,8], // rows
      [0,3,6], [1,4,7], [2,5,8], // cols
      [0,4,8], [2,4,6]           // diagonals
    ];

    // DOM refs
    const boardEl = document.getElementById('board');
    const turnBadge = document.getElementById('turnBadge');
    const messageEl = document.getElementById('message');
    const scoreX = document.getElementById('scoreX');
    const scoreO = document.getElementById('scoreO');
    const scoreT = document.getElementById('scoreT');
    const restartBtn = document.getElementById('restartBtn');
    const resetScoreBtn = document.getElementById('resetScoreBtn');
    const swapBtn = document.getElementById('swapBtn');

    // Create cells
    for (let i = 0; i < 9; i++) {
      const btn = document.createElement('button');
      btn.className = 'cell border border-gray-200 rounded-lg flex items-center justify-center text-4xl font-bold text-gray-800 bg-white transition transform';
      btn.dataset.index = i;
      btn.addEventListener('click', onCellClick);
      btn.setAttribute('aria-label', `Cell ${i+1}`);
      boardEl.appendChild(btn);
    }

    // Handle cell click
    function onCellClick(e) {
      const idx = Number(e.currentTarget.dataset.index);
      if (!state.running) return; // ignore when round finished
      if (state.board[idx]) return; // occupied

      // Put the symbol
      state.board[idx] = state.currentPlayer;
      renderBoard();

      // Check for win or tie
      const winnerLine = checkWin();
      if (winnerLine) {
        // We have a winner
        state.running = false;
        const winner = state.currentPlayer;
        state.scores[winner]++;
        highlightWin(winnerLine);
        messageEl.textContent = `${winner} wins!`; 
        updateScoreDisplay();
        turnBadge.textContent = `${winner} won`;
        return;
      }

      if (state.board.every(Boolean)) {
        // tie
        state.running = false;
        state.scores.T++;
        messageEl.textContent = `It's a tie!`;
        updateScoreDisplay();
        turnBadge.textContent = `Tie`;
        return;
      }

      // Toggle player
      state.currentPlayer = state.currentPlayer === 'X' ? 'O' : 'X';
      updateTurnDisplay();
    }

    // Check for a win and return winning triple if exists
    function checkWin() {
      for (const line of wins) {
        const [a,b,c] = line;
        if (state.board[a] && state.board[a] === state.board[b] && state.board[a] === state.board[c]) {
          return line; // indices of winning cells
        }
      }
      return null;
    }

    // Highlight the winning line
    function highlightWin(line) {
      if (!line) return;
      line.forEach(i => {
        const cell = boardEl.children[i];
        cell.classList.add('winning');
      });
    }

    // Render board to DOM
    function renderBoard() {
      for (let i = 0; i < 9; i++) {
        const cell = boardEl.children[i];
        const val = state.board[i];
        cell.textContent = val || '';
        // color players differently
        cell.classList.remove('text-indigo-700','text-rose-600');
        if (val === 'X') cell.classList.add('text-indigo-700');
        if (val === 'O') cell.classList.add('text-rose-600');
      }
    }

    // Update turn badge and message
    function updateTurnDisplay() {
      turnBadge.textContent = `${state.currentPlayer}'s turn`;
      messageEl.textContent = `Player ${state.currentPlayer}, make a move.`;
    }

    // Update score UI
    function updateScoreDisplay() {
      scoreX.textContent = `X: ${state.scores.X}`;
      scoreO.textContent = `O: ${state.scores.O}`;
      scoreT.textContent = `Ties: ${state.scores.T}`;
    }

    // Restart current round (clears board but keeps scores)
    function restartRound() {
      state.board = Array(9).fill(null);
      state.running = true;
      // starting player stays the same (startedBy)
      state.currentPlayer = state.startedBy;
      // reset visuals
      for (let i = 0; i < 9; i++) {
        const cell = boardEl.children[i];
        cell.classList.remove('winning');
      }
      renderBoard();
      updateTurnDisplay();
      messageEl.textContent = `New round — ${state.currentPlayer} starts.`;
    }

    // Reset scores fully and restart
    function resetScores() {
      state.scores = { X: 0, O: 0, T: 0 };
      state.startedBy = 'X';
      state.currentPlayer = state.startedBy;
      updateScoreDisplay();
      restartRound();
    }

    // Swap who will start next round (helps practice strategy)
    function swapStartingPlayer() {
      state.startedBy = state.startedBy === 'X' ? 'O' : 'X';
      state.currentPlayer = state.startedBy;
      restartRound();
    }

    // Wire buttons
    restartBtn.addEventListener('click', restartRound);
    resetScoreBtn.addEventListener('click', () => {
      if (confirm('Reset scores and start fresh?')) resetScores();
    });
    swapBtn.addEventListener('click', swapStartingPlayer);

    // Initialize UI
    updateScoreDisplay();
    updateTurnDisplay();
    renderBoard();

    // Keyboard accessibility: number keys 1-9 map to cells
    window.addEventListener('keydown', (e) => {
      if (!state.running) return;
      const key = e.key;
      if (/^[1-9]$/.test(key)) {
        // map 1..9 to cells (1 is top-left)
        const idx = Number(key) - 1;
        const cell = boardEl.children[idx];
        cell.focus();
        cell.click();
      }
    });

  </script>
</body>
</html>
